Adapted from ECE444 course material
